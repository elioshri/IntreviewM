######################################################################
# ğŸ“Œ 05 â€“ NumPy: ××“×¨×™×š ××œ× ×œ×“××˜× ×× ×œ×™×¡×˜
#
# ××” ×™×© ×¤×”:
#  1) ×™×¦×™×¨×ª ××¢×¨×›×™× ×•×‘×“×™×§×ª ×××¤×™×™× ×™×
#  2) ××™× ×“×•×§×¡, ×—×™×ª×•×›×™×, ××¡×›×•×ª
#  3) ×¤×¢×•×œ×•×ª ××ª××˜×™×•×ª, ×¡×˜×˜×™×¡×˜×™×§×” ×•××’×¨×’×¦×™×”
#  4) ×©×™× ×•×™×™× ×‘×¦×•×¨×ª ××¢×¨×š (reshape/transpose/stack)
#  5) ×‘×¨×•×“×§××¡×˜×™× ×’ (Broadcasting)
#  6) ×¤×¢×•×œ×•×ª ×¢×œ ×˜×§×¡×˜/×ª××¨×™×›×™× ×‘-NumPy
#  7) Missing Values (NaN/inf)
#  8) ×•×§×˜×•×¨×™×–×¦×™×” ××•×œ ×œ×•×œ××•×ª â€“ ×‘×™×¦×•×¢×™×
#  9) ×“×•×’×××•×ª ×× ×œ×™×¡×˜×™×•×ª: ×§×•×¨×œ×¦×™×”, ×¡×˜× ×“×¨×˜×™×–×¦×™×”, bins
# 10) ×©××™×¨×”/×˜×¢×™× ×” (np.save, np.load, np.savetxt, np.genfromtxt)
######################################################################

import numpy as np

# ==============================================================
# 1) ×™×¦×™×¨×ª ××¢×¨×›×™× ×•×‘×“×™×§×ª ×××¤×™×™× ×™×
# ==============================================================

a = np.array([1,2,3,4])
b = np.array([[1,2,3],[4,5,6]], dtype=np.float64)

print("\n[a] ", a)
print("[b] \n", b)
print("shape:", b.shape, "dtype:", b.dtype, "ndim:", b.ndim, "size:", b.size)

# ×¤×•× ×§×¦×™×•×ª ×‘× ×™×™×”
z = np.zeros((2,3))
o = np.ones((2,2))
rng = np.arange(0,10,2)   # ×›××• range ××‘×œ ××—×–×™×¨ array
lin = np.linspace(0,1,5)  # 5 ×¢×¨×›×™× ×-0 ×¢×“ 1
eye = np.eye(3)           # ××˜×¨×™×¦×ª ×™×—×™×“×” 3x3
rnd = np.random.rand(2,3) # ××§×¨×™ (0â€“1)

# ==============================================================
# 2) ××™× ×“×•×§×¡, ×—×™×ª×•×›×™×, ××¡×›×•×ª
# ==============================================================

arr = np.array([[10,20,30],[40,50,60],[70,80,90]])
print("\n[arr]\n", arr)

# ×’×™×©×” ×œ×¤×™ ××™× ×“×§×¡
print("arr[0,1] =", arr[0,1])   # 20
print("×©×•×¨×” ×¨××©×•× ×”:", arr[0])
print("×¢××•×“×” ×©× ×™×”:", arr[:,1])

# ×—×™×ª×•×š (slicing)
print("arr[0:2, 1:3]\n", arr[0:2,1:3])

# ××¡×›×•×ª
mask = arr > 50
print("mask\n", mask)
print("arr[mask]\n", arr[mask]) # ×›×œ ×”×¢×¨×›×™× ××¢×œ 50

# ××™× ×“×•×§×¡ ×œ×¤×™ ×¨×©×™××ª ××™×§×•××™×
print("arr[[0,2],[1,0]] =", arr[[0,2],[1,0]])  # [20,70]


# ==============================================================
# 3) ×¤×¢×•×œ×•×ª ××ª××˜×™×•×ª, ×¡×˜×˜×™×¡×˜×™×§×” ×•××’×¨×’×¦×™×”
# ==============================================================

x = np.array([1,2,3,4,5])
print("\n×—×™×‘×•×¨:", x+10, "×›×¤×œ:", x*2)
print("×¡×›×•×:", x.sum(), "×××•×¦×¢:", x.mean(), "×©×•× ×•×ª:", x.var(), "×¡×˜×™×™×ª ×ª×§×Ÿ:", x.std())
print("××§×¡×™××•×:", x.max(), "argmax:", x.argmax(), "××™× ×™××•×:", x.min())

# ×¤×¢×•×œ×•×ª ×©×•×¨×”/×¢××•×“×” ×‘××˜×¨×™×¦×”
M = np.array([[1,2,3],[4,5,6]])
print("sum axis=0 (×¢××•×“×•×ª):", M.sum(axis=0))
print("sum axis=1 (×©×•×¨×•×ª):", M.sum(axis=1))

# ×§×•×¨×œ×¦×™×” ×•××˜×¨×™×¦×”
print("×§×•×¨×œ×¦×™×”:\n", np.corrcoef(M))


# ==============================================================
# 4) ×©×™× ×•×™×™× ×‘×¦×•×¨×ª ××¢×¨×š (reshape/transpose/stack)
# ==============================================================

r = np.arange(1,7)        # [1..6]
R = r.reshape((2,3))      # ××˜×¨×™×¦×” 2x3
print("\n[R]\n", R)

Rt = R.T                  # ×˜×¨× ×¡×¤×•×–
print("transpose\n", Rt)

# stack â€“ ×—×™×‘×•×¨ ××¢×¨×›×™×
c1 = np.array([1,2,3])
c2 = np.array([4,5,6])
print("stack axis=0\n", np.stack([c1,c2], axis=0))
print("stack axis=1\n", np.stack([c1,c2], axis=1))


# ==============================================================
# 5) ×‘×¨×•×“×§××¡×˜×™× ×’ (Broadcasting)
# ==============================================================

X = np.array([[1,2,3],[4,5,6]])
v = np.array([10,20,30])
print("\nX+v\n", X+v)   # ×›×œ ×©×•×¨×” ××§×‘×œ×ª ××ª v

col = np.array([[1],[2]])
print("X*col\n", X*col) # ×›×œ ×¢××•×“×” ××•×›×¤×œ×ª ×‘×¢×¨×›×™×


# ==============================================================
# 6) ×˜×§×¡×˜ ×•×ª××¨×™×›×™× ×‘-NumPy
# ==============================================================

dates = np.array(["2025-01-01","2025-02-01"], dtype="datetime64[D]")
print("\n[dates]", dates, dates.dtype)
print("days diff:", dates[1]-dates[0])  # 31 ×™××™×

# ×–××Ÿ ×“×§×”/×©×¢×”
ts = np.array(["2025-01-01T12:00","2025-01-01T14:30"], dtype="datetime64[m]")
print("minutes diff:", ts[1]-ts[0])


# ==============================================================
# 7) Missing Values (NaN/inf)
# ==============================================================

xx = np.array([1,2,np.nan,4,np.inf])
print("\nNaN check:", np.isnan(xx))
print("isfinite:", np.isfinite(xx))

# ×˜×™×¤×•×œ â€“ ×œ×”×—×œ×™×£ NaN ×‘-0
xx_clean = np.nan_to_num(xx, nan=0.0, posinf=9999)
print("clean:", xx_clean)


# ==============================================================
# 8) ×•×§×˜×•×¨×™×–×¦×™×” ××•×œ ×œ×•×œ××•×ª â€“ ×‘×™×¦×•×¢×™×
# ==============================================================

N = 10**5
data = np.arange(N)
# âŒ ×œ×•×œ××”
%timeit [x**2 for x in data]  # (×‘-Jupyter)
# âœ… NumPy vectorized
%timeit data**2


# ==============================================================
# 9) ×“×•×’×××•×ª ×× ×œ×™×¡×˜×™×•×ª
# ==============================================================

# ×¡×˜× ×“×¨×˜×™×–×¦×™×” (Z-score)
vals = np.array([10,20,30,40])
zscore = (vals - vals.mean()) / vals.std()
print("\n[zscore]", zscore)

# bins â€“ ×—×œ×•×§×ª ×¢×¨×›×™× ×œ×§×˜×’×•×¨×™×•×ª
ages = np.array([5,12,17,25,40,70])
bins = [0,12,18,35,60,120]
labels = ["child","teen","young_adult","adult","senior"]
cats = np.array(pd.cut(ages, bins=bins, labels=labels))
print("[ages bins]", list(zip(ages,cats)))

# ××˜×¨×™×¦×ª ×§×•×¨×œ×¦×™×” ×©×œ ×“××˜×” ××§×¨××™
mat = np.random.randn(5,4)
corr = np.corrcoef(mat,rowvar=False)
print("\n[corr matrix]\n", corr)


# ==============================================================
# 10) ×©××™×¨×”/×˜×¢×™× ×”
# ==============================================================

arr = np.arange(10)

# ×©××™×¨×” ×‘×™× ××¨×™×ª
np.save("arr.npy", arr)
arr2 = np.load("arr.npy")

# ×©××™×¨×” ×˜×§×¡×˜×•××œ×™×ª
np.savetxt("arr.csv", arr, delimiter=",")
arr3 = np.genfromtxt("arr.csv", delimiter=",")

print("\n[save/load] arr2:", arr2, "arr3:", arr3)
######################################################################
# ğŸ’¡ TL;DR â€“ ×˜×™×¤×™× ×—×©×•×‘×™×:
# â€¢ ×”×©×ª××©×• ×‘-ndarray (×œ× ×œ×•×œ××•×ª) â†’ ×¤×™ ×¢×©×¨×•×ª ×‘×™×¦×•×¢×™×.
# â€¢ axis=0 = ×©×•×¨×•×ª (down), axis=1 = ×¢××•×“×•×ª (across).
# â€¢ NaN/inf â†’ np.isnan / np.isfinite / np.nan_to_num.
# â€¢ datetime64 ×™×¢×™×œ ×××•×“, ×¢×“×™×£ ×¢×œ pandas ×œ×•×§×˜×•×¨ ×¤×©×•×˜.
# â€¢ Broadcasting ×—×•×¡×š ×”××•×Ÿ ×§×•×“.
# â€¢ ×¢×“×™×£ np.save/np.load ×¢×œ pickle â€“ ×™×•×ª×¨ ××”×™×¨ ×•×§×•××¤×§×˜×™.
######################################################################
