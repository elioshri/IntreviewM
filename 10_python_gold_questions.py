######################################################################
# ğŸ“Œ 10 â€“ Python Gold Questions (Data Analyst)
#
# ×©××œ×•×ªâ€“×ª×©×•×‘×•×ª ××§×™×¤×•×ª ×‘× ×•×©××™× ×©×•× ×™× (××¢×‘×¨ ×œ×¤× ×“×¡ ×•× ×××¤×™×™),
# ×¢× ×“×’×© ×¢×œ ××” ×©×‘×“×¨×š ×›×œ×œ "× ×•×¤×œ ×‘××‘×—×Ÿ" ××• ××¤×ª×™×¢.
######################################################################

import re, json, statistics
import pandas as pd
import numpy as np

# ==============================================================
# Q1: ××¦× ××¡×¤×¨ ×”×•×¤×¢×•×ª ×©×œ ×›×œ ××™×œ×” ×‘××©×¤×˜
# ==============================================================

text = "data analyst role data prediction data"
counts = {}
for w in text.split():
    counts[w] = counts.get(w, 0) + 1
print("Q1:", counts)

# ==============================================================
# Q2: flatten â€“ ×”×¤×•×š ×¨×©×™××ª ×¨×©×™××•×ª ×œ×¨×©×™××” ××—×ª
# ==============================================================

nested = [[1,2],[3,4],[5]]
flat = [x for sub in nested for x in sub]
print("Q2:", flat)

# ==============================================================
# Q3: ××¦× ××ª ×©× ×™ ×”×¢×¨×›×™× ×”×’×“×•×œ×™× ×‘×™×•×ª×¨ ×‘×¨×©×™××” (×‘×œ×™ sort ××œ×)
# ==============================================================

nums = [10,4,99,23,54,87]
largest, second = float("-inf"), float("-inf")
for n in nums:
    if n > largest:
        largest, second = n, largest
    elif n > second:
        second = n
print("Q3:", largest, second)

# ==============================================================
# Q4: Regex â€“ ×—×™×œ×•×¥ ×›×œ ×”××™××™×™×œ×™× ××˜×§×¡×˜
# ==============================================================

txt = "Contact us at data@test.com or info@company.co.il"
emails = re.findall(r"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}", txt)
print("Q4:", emails)

# ==============================================================
# Q5: ×§×¨×™××ª JSON ×•×”××¨×” ×œ-DataFrame
# ==============================================================

doc = '[{"id":1,"score":90},{"id":2,"score":85}]'
parsed = json.loads(doc)
df = pd.DataFrame(parsed)
print("Q5:\n", df)

# ==============================================================
# Q6: ×¡×˜×˜×™×¡×˜×™×§×” â€“ ×—×¦×™×•×Ÿ, ×¡×˜×™×™×ª ×ª×§×Ÿ, ×§×•×•×¨×˜×™×œ×™×
# ==============================================================

arr = [10,20,30,40,50,100]
print("Q6 median:", statistics.median(arr),
      "std:", statistics.pstdev(arr),
      "q1,q3:", np.percentile(arr,[25,75]))

# ==============================================================
# Q7: ×¤×•× ×§×¦×™×” ×¨×§×•×¨×¡×™×‘×™×ª â€“ ×—×™×©×•×‘ faculty (n!)
# ==============================================================

def fact(n):
    return 1 if n<=1 else n*fact(n-1)

print("Q7 5!:", fact(5))

# ==============================================================
# Q8: ×›×ª×™×‘×” ×•×§×¨×™××” ×©×œ CSV ×§×˜×Ÿ
# ==============================================================

df.to_csv("out.csv", index=False)
df_back = pd.read_csv("out.csv")
print("Q8 read:", df_back.head())

# ==============================================================
# Q9: ×‘×“×™×§×ª ××™×–×•×Ÿ ×¡×•×’×¨×™×™× ×‘××—×¨×•×–×ª
# ==============================================================

s = "((1+2)*(3+4))"
stack = []
ok = True
for ch in s:
    if ch=="(":
        stack.append(ch)
    elif ch==")":
        if not stack: ok=False; break
        stack.pop()
ok = ok and not stack
print("Q9 balanced?", ok)

# ==============================================================
# Q10: ×—×™×©×•×‘ ×§×•×¨×œ×¦×™×” ×™×“× ×™×ª ×‘×™×Ÿ ×©× ×™ ×•×§×˜×•×¨×™×
# ==============================================================

x = np.array([1,2,3,4,5])
y = np.array([2,4,5,4,5])
corr = np.corrcoef(x,y)[0,1]
print("Q10 corr:", corr)

######################################################################
# ğŸ’¡ ×˜×™×¤×™×:
# â€¢ ×ª××™×“ ×œ×—×©×•×‘ ×¢×œ edge-cases (×¨×©×™××” ×¨×™×§×”, None, ×˜×§×¡×˜ ×‘×œ×™ ××™××™×™×œ×™×).
# â€¢ Regex â€“ ×—×•×¡×š ×”×¨×‘×” ×–××Ÿ, ×©×•×•×” ×œ×–×›×•×¨ ×‘×™×˜×•×™×™× ×‘×¡×™×¡×™×™×.
# â€¢ recursion ×œ× × ×¤×•×¥ ×‘×× ×œ×™×¡×˜×™×, ××‘×œ ×œ×¤×¢××™× ×©×•××œ×™× ×›×§×˜×¢ ×œ×•×’×™.
######################################################################
