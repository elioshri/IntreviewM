######################################################################
# ğŸ“Œ 08 â€“ Python Q&A: Beginner â†’ Intermediate (Data Analyst)
#
# ×“×•×’×××•×ª ×œ×©××œ×•×ª ×§×œ××¡×™×•×ª + ×¤×ª×¨×•× ×•×ª ×•×”×¡×‘×¨×™× ×‘×¢×‘×¨×™×ª
# ×”× ×•×©××™×: ×œ×•×œ××•×ª, ×ª× ××™×, ×¨×©×™××•×ª, ××™×œ×•× ×™×, ×¤×•× ×§×¦×™×•×ª, ××—×¨×•×–×•×ª,
#           pandas ×‘×¡×™×¡×™, NumPy ×‘×¡×™×¡×™
######################################################################

import numpy as np
import pandas as pd

# ==============================================================
# ğŸ§ª Q1: ×”×¤×•×š ××—×¨×•×–×ª
# ==============================================================

s = "Data Analyst"
ans = s[::-1]
print("Q1:", ans)
# ×”×¡×‘×¨: slicing ×¢× ×¦×¢×“ -1 ×”×•×¤×š ××ª ×”××—×¨×•×–×ª.

# ==============================================================
# ğŸ§ª Q2: ×¡×¤×™×¨×ª ×”×•×¤×¢×•×ª ×©×œ ×ª×•×•×™×
# ==============================================================

from collections import Counter
text = "banana"
cnt = Counter(text)
print("Q2:", cnt)
# {'b':1, 'a':3, 'n':2}

# ==============================================================
# ğŸ§ª Q3: ×¨×©×™××ª ×¨×™×‘×•×¢×™× ×-1 ×¢×“ 10
# ==============================================================

squares = [n**2 for n in range(1,11)]
print("Q3:", squares)

# ==============================================================
# ğŸ§ª Q4: ×”×“×¤×¡ ×¨×§ ×–×•×’×™×™× ××ª×•×š ×¨×©×™××”
# ==============================================================

nums = [1,2,3,4,5,6]
evens = [n for n in nums if n%2==0]
print("Q4:", evens)

# ==============================================================
# ğŸ§ª Q5: ×”×—×œ×¤×ª ××¤×ª×—/×¢×¨×š ×‘××™×œ×•×Ÿ
# ==============================================================

d = {"a":1,"b":2,"c":3}
swapped = {v:k for k,v in d.items()}
print("Q5:", swapped)

# ==============================================================
# ğŸ§ª Q6: ×¤×•× ×§×¦×™×” ×©××—×–×™×¨×” ×××•×¦×¢ ×¨×©×™××”
# ==============================================================

def avg(lst):
    return sum(lst)/len(lst) if lst else None

print("Q6:", avg([1,2,3,4,5]))

# ==============================================================
# ğŸ§ª Q7: ×›××” ××™×œ×™× ×™×© ×‘××©×¤×˜
# ==============================================================

sentence = "Data Analyst role in sports prediction"
word_count = len(sentence.split())
print("Q7:", word_count)

# ==============================================================
# ğŸ§ª Q8: ×©×™××•×© ×‘-any/all
# ==============================================================

lst = [0,0,1,0]
print("Q8 any:", any(lst))  # True (×›×™ ×™×© 1)
print("Q8 all:", all(lst))  # False (×›×™ ×™×© ××¤×¡×™×)

# ==============================================================
# ğŸ§ª Q9: NumPy â€“ ××¦× ×××•×¦×¢, ××§×¡×™××•× ×•××™×§×•× ×”××§×¡×™××•×
# ==============================================================

arr = np.array([5,8,2,9,3])
print("Q9 mean:", arr.mean(), "max:", arr.max(), "argmax:", arr.argmax())

# ==============================================================
# ğŸ§ª Q10: NumPy â€“ ×¡× ×Ÿ ×¢×¨×›×™× ××¢×œ 5
# ==============================================================

print("Q10:", arr[arr > 5])   # [8,9]

# ==============================================================
# ğŸ§ª Q11: pandas â€“ DataFrame ×§×˜×Ÿ ×•×¡×™× ×•×Ÿ
# ==============================================================

df = pd.DataFrame({
    "name":["Dana","Avi","Chen","Lior"],
    "score":[90,80,95,70]
})
print("\nQ11 DataFrame:\n", df)

# ×¡×™× ×•×Ÿ ×ª×œ××™×“×™× ×¢× ×¦×™×•×Ÿ >=85
print("Q11 filtered:\n", df[df["score"]>=85])

# ==============================================================
# ğŸ§ª Q12: pandas â€“ ×—×™×©×•×‘ ×××•×¦×¢ ×¦×™×•×Ÿ
# ==============================================================

print("Q12 avg score:", df["score"].mean())

# ==============================================================
# ğŸ§ª Q13: pandas â€“ ×”×•×¡×¤×ª ×¢××•×“×” ×¢× ×“×™×¨×•×’ (rank)
# ==============================================================

df["rank"] = df["score"].rank(ascending=False, method="dense").astype(int)
print("Q13:\n", df)

# ==============================================================
# ğŸ§ª Q14: pandas â€“ GroupBy ×¡×›×•× ××›×™×¨×•×ª ×œ×œ×§×•×—
# ==============================================================

orders = pd.DataFrame({
    "cust":[1,1,2,2,3],
    "amount":[100,150,200,80,120]
})
print("\nQ14 orders:\n", orders)

print("Q14 groupby sum:\n",
      orders.groupby("cust")["amount"].sum().reset_index())

# ==============================================================
# ğŸ§ª Q15: pandas â€“ ××¦×™××ª ×××•×¦×¢ × ×¢ (rolling)
# ==============================================================

sales = pd.Series([100,120,80,200,150], name="sales")
print("\nQ15 rolling mean:\n", sales.rolling(3, min_periods=1).mean())

######################################################################
# ğŸ’¡ ×˜×™×¤×™×:
# â€¢ ×¤×ª×— ×‘×¢×™×•×ª ×¢× ×›×œ×™× ×¤×©×•×˜×™×: list comprehension, dict comprehension.
# â€¢ ×›×œ×™× ××•×‘× ×™× (min/max/sum/sorted/len) â€“ ×¢×•× ×™× ×¢×œ 70% ××”×©××œ×•×ª.
# â€¢ pandas: ×ª××™×“ ×ª×‘×“×•×§ .head() ×•-.dtypes.
# â€¢ NumPy: ××¡×›×•×ª (arr[cond]) ×–×” ×˜×¨×™×§ ×—×–×§ ×××•×“.
######################################################################
